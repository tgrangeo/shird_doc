---
title: Microsoft
description:  Integrate Microsoft authentication flow in Shird.
navigation:
    icon: i-logos-microsoft-icon
seo:
    description:  Integrate Microsoft authentication flow in Shird.
---

## Introduction

The **MicrosoftProvider** handles the Microsoft OAuth authentication flow within Shird.
It uses a **WebView** to perform the login process securely and return the user's authentication cookies or tokens once the flow completes.

This provider requires a `GlobalKey<NavigatorState>` because navigation is used to open and close the WebView.

## Requirements

To use the **MicrosoftProvider**, you must integrate a **WebView** to handle the authentication UI flow.
The WebView is responsible for:

* Opening the `loginUrl`
* Listening for the `callbackUrl`
* Extracting authentication cookies or tokens
* Returning them to the provider via `Navigator.pop(cookieMap)`

::warning
See more details at the [Login Method](/login-method/intro) section for an in-depth explanation of how authentication is launched and handled.
::
::warning
Currently only [webview_flutter](/login-method/webview_flutter) is implemented, please import in your pubspec.yaml:
```yaml
  shird_webview_flutter:
    git:
      url: https://gitlab.xefi.fr/xefi/xefi-interne/flutter_auth_provider
      path: packages/shird_webview_flutter
      ref: v0.1.2
```
and add the following line to the Shird declaration:
```ts
launchLogin: launchLoginWebview,
```
::


## Example Usage

```ts
final shird = Shird(
  providers: {
    microsoft: MicrosoftProvider(
      loginUrl: EnvironmentService.microsoftSsoUrl,
      callbackUrl: EnvironmentService.oauthCallbackUrl,
      navigatorKey: NavigationService.navigatorKey,
    ),
  },
);

// Trigger the Microsoft login flow
final result = await shird.authWith.microsoft();
```

## Notes

* Always provide a valid `navigatorKey` when declaring the provider.
* Ensure your **callback URL** matches the redirect URI registered in your Microsoft Azure app settings.
* The WebView should be configured with unrestricted JavaScript and cookie reading enabled to extract the login data properly.



"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _kit = await jitiImport("@nuxt/kit");
var _defu = await jitiImport("defu");
var _nodeFs = await jitiImport("node:fs");
var _nodePath = await jitiImport("node:path");
var _meta = await jitiImport("../utils/meta");
var _git = await jitiImport("../utils/git");var _default = exports.default =

(0, _kit.defineNuxtModule)({
  meta: {
    name: 'config'
  },
  async setup(_options, nuxt) {
    const dir = nuxt.options.rootDir;
    const url = (0, _meta.inferSiteURL)();
    const meta = await (0, _meta.getPackageJsonMetadata)(dir);
    const gitInfo = (await (0, _git.getLocalGitInfo)(dir)) || (0, _git.getGitEnv)();
    const siteName = nuxt.options?.site?.name || meta.name || gitInfo?.name || '';

    nuxt.options.llms = (0, _defu.defu)(nuxt.options.llms, {
      domain: url,
      title: siteName,
      description: meta.description || '',
      full: {
        title: siteName,
        description: meta.description || ''
      }
    });

    nuxt.options.site = (0, _defu.defu)(nuxt.options.site, {
      url,
      name: siteName,
      debug: false
    });

    nuxt.options.appConfig.header = (0, _defu.defu)(nuxt.options.appConfig.header, {
      title: siteName
    });

    nuxt.options.appConfig.seo = (0, _defu.defu)(nuxt.options.appConfig.seo, {
      titleTemplate: `%s - ${siteName}`,
      title: siteName,
      description: meta.description || ''
    });

    nuxt.options.appConfig.github = (0, _defu.defu)(nuxt.options.appConfig.github, {
      owner: gitInfo?.owner,
      name: gitInfo?.name,
      url: gitInfo?.url,
      branch: (0, _git.getGitBranch)()
    });

    /*
    ** I18N
    */
    if (nuxt.options.i18n && nuxt.options.i18n.locales) {
      const { resolve } = (0, _kit.createResolver)("file:///Users/dailyup/Documents/projects/auth_provider_docs_2/node_modules/docus/modules/config.ts");

      // Filter locales to only include existing ones
      const filteredLocales = nuxt.options.i18n.locales.filter((locale) => {
        const localeCode = typeof locale === 'string' ? locale : locale.code;

        // Check for JSON locale file
        const localeFilePath = resolve('../i18n/locales', `${localeCode}.json`);
        const hasLocaleFile = (0, _nodeFs.existsSync)(localeFilePath);

        // Check for content folder
        const contentPath = (0, _nodePath.join)(nuxt.options.rootDir, 'content', localeCode);
        const hasContentFolder = (0, _nodeFs.existsSync)(contentPath);

        if (!hasLocaleFile) {
          console.warn(`[Docus] Locale file not found: ${localeCode}.json - skipping locale "${localeCode}"`);
        }

        if (!hasContentFolder) {
          console.warn(`[Docus] Content folder not found: content/${localeCode}/ - skipping locale "${localeCode}"`);
        }

        return hasLocaleFile && hasContentFolder;
      });

      // Override strategy to prefix
      nuxt.options.i18n = {
        ...nuxt.options.i18n,
        strategy: 'prefix'
      };

      // Expose filtered locales
      nuxt.options.runtimeConfig.public.docus = {
        filteredLocales
      };

      nuxt.hook('i18n:registerModule', (register) => {
        const langDir = resolve('../i18n/locales');

        const locales = filteredLocales?.map((locale) => {
          return typeof locale === 'string' ?
          {
            code: locale,
            name: locale,
            file: `${locale}.json`
          } :
          {
            code: locale.code,
            name: locale.name || locale.code,
            file: `${locale.code}.json`
          };
        });

        register({
          langDir,
          locales
        });
      });
    }
  }
}); /* v9-e948c59121b67007 */
